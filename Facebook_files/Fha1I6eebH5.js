/*1347374288,178142493*/

if (window.CavalryLogger) { CavalryLogger.start_js(["af3cE"]); }

__d("ComposerXAttachment",["ComposerXStore","copyProperties"],function(a,b,c,d,e,f){var g=b('ComposerXStore'),h=b('copyProperties');function i(){}h(i.prototype,{getRoot:bagofholding,initWithComponents:function(j){},cleanup:bagofholding,reset:bagofholding,attachmentClassName:'',getComponent:function(j){return g.get(this._composerID,j);},canSwitchAway:bagof(true),setComposerID:function(j){this._composerID=j;}});e.exports=i;});
__d("ComposerXBootloadStatusAttachment",["event-extensions","function-extensions","Bootloader","Class","ComposerXAttachment","ComposerXController","CSS","DOM","DOMQuery","Input","Parent","copyProperties","csx","cx"],function(a,b,c,d,e,f){b('event-extensions');b('function-extensions');var g=b('Bootloader'),h=b('Class'),i=b('ComposerXAttachment'),j=b('ComposerXController'),k=b('CSS'),l=b('DOM'),m=b('DOMQuery'),n=b('Input'),o=b('Parent'),p=b('copyProperties'),q=b('csx'),r=b('cx'),s={};function t(u,v){this.parent.construct(this);this._root=u;this._config=v;}h.extend(t,i);p(t.prototype,{_attachmentIsActive:false,_bootloading:false,_fullVersion:false,_focusListener:null,_privacyWidgetTags:null,_scraper:null,_dragdrop:null,attachmentClassName:"_4j",getRoot:function(){return this._root;},initWithComponents:function(u){s[this._composerID]=this;this._attachmentIsActive=true;var v=m.find(this.getComponent('maininput').element,'textarea.input');if(this._fullVersion){this._fullInitWithComponents();}else if(!this._bootloading)if(m.contains(this._root,document.activeElement)){this._onInitialFocus();}else this._focusListener=Event.listen(v,'focus',this._onInitialFocus.bind(this));this.getComponent('maininput').instance.setPlaceholder(this._config.mentionsPlaceholder);if(!u)n.focus(v);},_fullInitWithComponents:function(){g.loadModules(['ComposerXPrivacyWidgetTags','URLScraper','URI','ComposerXDragDropPhoto'],function(u,v,w,x){this._tagger.init(this);this._privacyWidgetTags=new u(this);var y=m.find(this.getComponent('maininput').element,'textarea.input');if(!this._scraper){this._scraper=new v(y);this._scraper.subscribe('match',function(z,aa){var ba=new w('/ajax/composerx/attachment/link/scraper/');ba.addQueryData({scrape_url:encodeURIComponent(aa.url)});j.getAttachment(this._root,ba.toString());}.bind(this));}this._scraper.enable();this._scraper.check();if(this._config.plus_version)this._dragdrop=new x(this._root,this._composerID,this._config.targetID);}.bind(this));},cleanup:function(){this._attachmentIsActive=false;if(this._focusListener){this._focusListener.remove();this._focusListener=null;}if(this._fullVersion){this._tagger.cleanup();this._privacyWidgetTags.destroy();this._privacyWidgetTags=null;this._scraper.disable();if(this._dragdrop){this._dragdrop.deactivate();this._dragdrop=null;}}},reset:function(){var u=o.byClass(this._root,"child_was_focused");if(u)k.removeClass(u,"child_was_focused");this.getComponent('maininput').instance.setPlaceholder(this._config.mentionsPlaceholder);},canSwitchAway:function(){return !o.byClass(this._root,'async_saving');},setBootloadedContent:function(u,v,w){var x=m.find(this._root,"._3-6"),y=m.find(this._root,"._3-7");l.setContent(x,u.tagger_content);l.setContent(y,u.tagger_icons);j.addPlaceholders(this._root,this,w);this._tagger=v;this._fullVersion=true;if(this._attachmentIsActive){if(this._focusListener){this._focusListener.remove();this._focusListener=null;}this._fullInitWithComponents();}},_onInitialFocus:function(){j.getEndpoint(this._root,'/ajax/composerx/attachment/status/bootload/',true);this._bootloading=true;}});t.setBootloadedContent=function(u,v,w,x){var y=s[u];if(y)y.setBootloadedContent(v,w,x);};e.exports=t;});
__d("ComposerXEmptyAttachment",["Class","ComposerXAttachment","copyProperties"],function(a,b,c,d,e,f){var g=b('Class'),h=b('ComposerXAttachment'),i=b('copyProperties');function j(k){this.parent.construct(this);this._root=k;}g.extend(j,h);i(j.prototype,{getRoot:function(){return this._root;}});e.exports=j;});
__d("ComposerXMentionsInputReset",["DOMQuery","Input"],function(a,b,c,d,e,f){var g=b('DOMQuery'),h=b('Input');function i(j){var k=g.scry(j.element,'textarea.input')[0];j.instance.reset();h.reset(k);}e.exports=i;});
__d("ComposerXPrivacyWidgetReset",["Arbiter"],function(a,b,c,d,e,f){var g=b('Arbiter');function h(i){g.inform('Composer/changedtags',{withTags:[],mention:{},eventTag:false});}e.exports=h;});
__d("ComposerXTaggerIconReset",["CSS","cx"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('cx');function i(j){g.removeClass(j.element,"_4k");g.removeClass(j.element,"_4l");g.removeClass(j.element,"_4m");}e.exports=i;});
__d("ComposerXDatepickerIconReset",["CSS","cx"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('cx');function i(j){g.removeClass(j.element,"_t5");g.removeClass(j.element,"_4m");}e.exports=i;});
__d("TimelineStickyHeaderComposerX",["event-extensions","Arbiter","Bootloader","CSS","ComposerXController","DOMQuery","Parent","Run","TimelineComposerUtilities","TimelineContentLoader","TimelineStickyHeader","Vector","copyProperties","csx","cx"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('Bootloader'),i=b('CSS'),j=b('ComposerXController'),k=b('DOMQuery'),l=b('Parent'),m=b('Run'),n=b('TimelineComposerUtilities'),o=b('TimelineContentLoader'),p=b('TimelineStickyHeader'),q=b('Vector'),r=b('copyProperties'),s=b('csx'),t=b('cx');function u(w){return w&&l.byClass(w.getContext(),"_2wp");}function v(w){this._composerRoot=w;this._tokens=[n.listenToSetEstimatedDate(this._composerRoot,o.capsuleForCurrentSection),n.listenToPublish(this._composerRoot,this._close.bind(this)),g.subscribe('PhotoSnowlift.OPEN',this._close.bind(this)),g.subscribe('TimelineMLE/mleFlyoutShown',function(x,y){if(u(y)===this._composerRoot)j.reset(this._composerRoot);}.bind(this)),g.subscribe('composer/initializedAttachment',function(x,y){if(y.composerRoot===this._composerRoot){this._registerClickToDismiss();if(!y.isInitial)this._closeMLE();}else this._close();}.bind(this)),g.subscribe(p.ADJUST_WIDTH,this._toggleNarrowMode.bind(this))];this._clickCancelToken=n.listenToCancel(this._composerRoot,this._close.bind(this));m.onLeave(function(){while(this._tokens.length)this._tokens.pop().unsubscribe();this._clearClickDismissToken();if(this._clickCancelToken){this._clickCancelToken.remove();this._clickCancelToken=null;}}.bind(this));}r(v.prototype,{_toggleNarrowMode:function(event,w){h.loadModules(['Tooltip'],function(x){var y=q.getElementDimensions(w).x>400,z=k.scry(this._composerRoot,"._50");i.conditionClass(this._composerRoot,"_2wq",y);for(var aa=0;aa<z.length;aa++){var ba=z[aa],ca=k.getText(ba);if(y){x.set(ba,ca);}else x.remove(ba);}}.bind(this));return false;},_registerClickToDismiss:function(){var w=i.hasClass(k.find(this._composerRoot,"._yq"),"_4n");if(!w){this._clearClickDismissToken();return;}this._clickDismissToken=Event.listen(document.body,'click',function(x){var y=l.byClass(x.getTarget(),"_2wp");if(!y){this._close();this._clearClickDismissToken();}}.bind(this));},_clearClickDismissToken:function(){if(this._clickDismissToken){this._clickDismissToken.remove();this._clickDismissToken=null;}},_close:function(){this._clearClickDismissToken();this._closeMLE();j.reset(this._composerRoot);},_closeMLE:function(){h.loadModules(['TimelineMLE'],function(w){var x=w.getFlyout();if(u(x)===this._composerRoot)w.hideFlyout();}.bind(this));}});e.exports=v;});