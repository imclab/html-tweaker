/*1347329812,173213725*/

if (window.CavalryLogger) { CavalryLogger.start_js(["cJ6DG"]); }

__d("SubscriptionLevels",[],function(a,b,c,d,e,f){var g={ALL:'162318810514679',DEFAULT:'271670892858696',TOP:'266156873403755'};e.exports=g;});
__d("EditSubscriptions",["event-extensions","function-extensions","Arbiter","AsyncRequest","CSS","DOM","ge","Menu","Parent","SubscriptionLevels"],function(a,b,c,d,e,f){b('event-extensions');b('function-extensions');var g=b('Arbiter'),h=b('AsyncRequest'),i=b('CSS'),j=b('DOM'),k=b('ge'),l=b('Menu'),m=b('Parent'),n=b('SubscriptionLevels'),o=13,p=45,q=[n.ALL,n.DEFAULT,n.TOP],r={},s={},t={},u={},v={},w={},x={},y={},z={},aa={},ba={},ca="/ajax/follow/follow_profile.php",da="/ajax/follow/unfollow_profile.php",ea="/ajax/settings/notifications/notify_me.php",fa={},ga={},ha=null,ia=false;function ja(gb){return q.contains(gb);}function ka(gb,hb,ib,jb){var kb=m.byClass(jb,'uiMenuItem')||m.byClass(jb,'uiMenuXItem');if(!kb||!j.contains(gb,kb)){return;}else if(i.hasClass(kb,'SubscribeMenuSubscribeCheckbox')){if(t[hb]){na(gb,hb);}else ma(gb,hb);return false;}else if(i.hasClass(kb,'SubscribeMenuUnsubscribe')){na(gb,hb);return false;}else if(i.hasClass(kb,'SubscribeMenuSettingsItem')){ab(gb,true);return false;}else if(i.hasClass(kb,'SubscriptionMenuGoBack')){ab(gb,false);return false;}else if(i.hasClass(kb,'SubscriptionMenuItem')){la(gb,hb,ib,kb);return false;}else if(i.hasClass(kb,'SubscribeMenuNotifyMeCheckbox')){if(u[hb]){eb(gb,hb);}else db(gb,hb);return false;}}function la(gb,hb,ib,jb){if(i.hasClass(jb,'SubscriptionMenuLevel')){if(l.isItemChecked(jb))return;ya(gb,hb,ra(jb),true,ib);}else if(i.hasClass(jb,'SubscriptionMenuCategory')){va(hb,jb,!l.isItemChecked(jb),true,ib);}else if(i.hasClass(jb,'SubscriptionAppStory'))xa(hb,jb,!l.isItemChecked(jb),ib);}function ma(gb,hb){var ib={profile_id:hb};g.inform('FollowingUser',ib);new h().setURI(ca).setMethod('POST').setData({profile_id:hb,location:oa(gb)}).setErrorHandler(g.inform.curry('FollowUserFail',ib)).send();}function na(gb,hb){var ib={profile_id:hb};g.inform('UnfollowingUser',ib);new h().setURI(da).setMethod('POST').setData({profile_id:hb,location:oa(gb)}).setErrorHandler(g.inform.curry('UnfollowUserFail',ib)).send();}function oa(gb){if(i.hasClass(gb,'followButtonFlyout')){return o;}else return p;}function pa(gb,hb,ib){var jb={profile_id:gb,level:y[gb],custom_categories:z[gb],location:ib};new h().setURI('/ajax/follow/manage_subscriptions.php').setData(jb).send();}function qa(gb,hb){var ib=z[hb]||[],jb=l.getItems(gb);jb.forEach(function(kb){if(i.hasClass(kb,'SubscriptionMenuCategory')){var lb=ra(kb);if(ib.contains(lb)){ta(kb);}else ua(kb);}else if(i.hasClass(kb,'SubscriptionAppStory')){var mb=ra(kb);if(ga[hb]&&ga[hb][mb]){ta(kb);}else ua(kb);}});ya(gb,hb,y[hb],false);}function ra(gb){var hb=j.scry(gb,'input')[0];return hb&&hb.value;}function sa(gb){return j.find(gb,'a.itemAnchor');}function ta(gb){i.addClass(gb,'checked');sa(gb).setAttribute('aria-checked',true);}function ua(gb){i.removeClass(gb,'checked');sa(gb).setAttribute('aria-checked',false);}function va(gb,hb,ib,jb,kb){if(ib){ta(hb);}else ua(hb);var lb=ra(hb);if(ja(lb)){ib&&wa(gb,lb);}else if(ib){if(!z[gb].contains(lb))z[gb].push(lb);}else{var mb=z[gb].indexOf(lb);if(mb!==-1)z[gb].splice(mb,1);}if(jb)pa(gb,lb,kb);}function wa(gb,hb){y[gb]=hb;g.inform('SubscriptionLevelUpdated',{profile_id:gb,level:hb});}function xa(gb,hb,ib,jb){var kb='/ajax/feed/filter_action/',lb=ra(hb),mb={actor_id:gb,app_id:lb};if(ib){ta(hb);kb+='resubscribe_user_app/';mb.action='resubscribe_user_app';if(!ga[gb])ga[gb]={};ga[gb][lb]=true;}else{ua(hb);kb+='unsubscribe_user_app_checkbox/';mb.action='unsubscribe_user_app_checkbox';if(ga[gb])ga[gb][lb]=false;}new h().setURI(kb).setData(mb).send();}function ya(gb,hb,ib,jb,kb){var lb=j.scry(gb,'.SubscriptionMenuLevel'),mb=null;lb.forEach(function(nb){if(ra(nb)==ib){mb=nb;}else if(l.isItemChecked(nb))va(hb,nb,false,false);});mb&&va(hb,mb,true,jb,kb);}function za(gb,hb,ib){t[hb]=ib;i.conditionClass(gb,'isUnsubscribed',!ib);var jb=j.scry(gb,'li.SubscribeMenuSubscribeCheckbox');if(jb.length!==0){var kb=jb[0];if(ib){ta(kb);}else ua(kb);}}function ab(gb,hb){i.conditionClass(gb,'subscriptionMenuOpen',hb);}function bb(gb,hb,ib){var jb=j.find(gb,".FriendListSubscriptionsMenu"),kb=j.find(jb,".uiMenuInner");if(ha!=null)ha.forEach(function(lb){kb.removeChild(lb);});ib.forEach(function(lb){kb.appendChild(lb);});ha=ib;}g.subscribe('UnfollowUser',function(gb,hb){if(aa[hb.profile_id]){wa(hb.profile_id,aa[hb.profile_id]);z[hb.profile_id]=ba[hb.profile_id].slice();}});g.subscribe('UpdateSubscriptionLevel',function(gb,hb){var ib=hb.profile_id+'',jb=hb.level+'';wa(ib,jb);var kb;for(kb in r)if(r[kb]===ib){var lb=k(kb);lb&&ya(lb,ib,jb,false);}});function cb(gb,hb,ib){u[hb]=ib;var jb=w[hb]&&!ia,kb=j.scry(gb,'li.SubscribeMenuNotifyMeCheckbox');if(kb.length!==0){var lb=kb[0];i.conditionShow(lb,!jb);i.conditionShow(j.find(gb,'li.SubscribeMenuNotifyMeCheckboxSeparator'),!jb);if(ib){ta(lb);}else ua(lb);}}function db(gb,hb){var ib={profile_id:hb};g.inform('EnableNotifsForUser',ib);new h().setURI(ea).setMethod('POST').setData({notifier_id:hb,enable:true}).setErrorHandler(g.inform.curry('EnableNotifsForUserFail',ib)).send();}function eb(gb,hb){var ib={profile_id:hb};g.inform('DisableNotifsForUser',ib);new h().setURI(ea).setMethod('POST').setData({notifier_id:hb,enable:false}).setErrorHandler(g.inform.curry('DisableNotifsForUserFail',ib)).send();}var fb={init:function(gb,hb,ib){var jb=j.getID(gb);if(!r[jb])Event.listen(gb,'click',function(kb){return ka(gb,r[jb],ib,kb.getTarget());});if(ib===p&&fa[hb].length)bb(gb,hb,fa[hb]);if(y[hb])qa(gb,hb);r[jb]=hb;i.conditionClass(gb,'NonFriendSubscriptionMenu',!s[hb]);i.conditionClass(gb,'cannotSubscribe',!v[hb]);i.conditionClass(gb,'noSubscriptionLevels',w[hb]&&!x[hb]);i.conditionClass(gb,'noSubscribeCheckbox',!s[hb]&&!w[hb]);za(gb,hb,t[hb]);cb(gb,hb,u[hb]);g.subscribe(['FollowUser','FollowingUser','UnfollowUserFail'],function(kb,lb){za(gb,hb,true);}.bind(this));g.subscribe(['UnfollowUser','UnfollowingUser','FollowUserFail'],function(kb,lb){g.inform('SubMenu/Reset');za(gb,hb,false);}.bind(this));g.subscribe(['EnableNotifsForUser','DisableNotifsForUserFail'],function(kb,lb){cb(gb,hb,true);}.bind(this));g.subscribe(['DisableNotifsForUser','EnableNotifsForUserFail'],function(kb,lb){cb(gb,hb,false);}.bind(this));ab(gb,false);},getSubscriptions:function(gb){return {level:y[gb],custom_categories:z[gb]};},setSubscriptions:function(gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb){wa(gb,mb+'');s[gb]=hb;t[gb]=ib;v[gb]=jb;w[gb]=kb;x[gb]=lb;aa[gb]=ob+'';z[gb]=nb.map(String);ba[gb]=pb.map(String);fa[gb]=sb;u[gb]=qb;ia=rb;}};e.exports=a.EditSubscriptions||fb;});
__d("SubscriptionFlyoutController",["Arbiter","CSS","DataStore","EditSubscriptions","Hovercard","HoverFlyout","$"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('DataStore'),j=b('EditSubscriptions'),k=b('Hovercard'),l=b('HoverFlyout'),m=b('$'),n=null,o,p,q;function r(){var v=j.getSubscriptions(q);if(v){var w=v.custom_categories;if(w&&w.length===0)g.inform('UnfollowUser',{profile_id:q,from_hide_flyout:true});}}function s(v,w){q=i.get(w,'profile_id');var x=i.get(w,'loc');j.init(p,q,x);h.addClass(w,'selected');h.addClass(w,'uiButtonHover');if(i.get(w,'onclose'))clearTimeout(i.remove(w,'onclosetimeout'));}function t(v,w){q=null;h.removeClass(w,'selected');h.removeClass(w,'uiButtonHover');if(i.get(w,'onclose'))i.set(w,'onclosetimeout',function(){var x=i.remove(w,'onclose');x&&x();}.defer(1500));}var u={init:function(v,w){u.init=bagofholding;o=v;p=m(w);n=new l();n.init(v);n.setShowDelay(100).setHideDelay(150);n.subscribe('show',s);n.subscribe('hide',t);g.subscribe(['UnfollowUser','UnfollowingUser'],function(x,y){if(!y.from_hide_flyout&&y.profile_id==q){if(k.contains&&o)if(k.contains(o.getContext()))k.hide();n.hideFlyout(true);}});},initNode:function(v,w,x){i.set(v,'profile_id',w);i.set(v,'loc',x);n.initNode(v);},setActiveNode:function(v){n.setActiveNode(v);},show:function(v){n.showFlyout(v,true);},setCloseListener:function(v,w){if(n.getActiveNode()!==v){w();}else i.set(v,'onclose',w);}};e.exports=a.SubscriptionFlyoutController||u;});
__d("legacy:dom-collect",["collectDataAttributes"],function(a,b,c,d){a.collect_data_attribs=b('collectDataAttributes');},3);
__d("DialogHideOnSuccess",["copyProperties","CSS","cx"],function(a,b,c,d,e,f){var g=b('copyProperties'),h=b('CSS'),i=b('cx');function j(k){this._layer=k;}g(j.prototype,{_subscription:null,enable:function(){this._subscription=this._layer.subscribe('success',this._handle.bind(this));},disable:function(){this._subscription.unsubscribe();this._subscription=null;},_handle:function(k,event){if(h.hasClass(event.getTarget(),"_s"))this._layer.hide();}});e.exports=j;});
__d("LayerRemoveOnHide",["function-extensions","DOM","copyProperties"],function(a,b,c,d,e,f){b('function-extensions');var g=b('DOM'),h=b('copyProperties');function i(j){this._layer=j;}h(i.prototype,{_subscription:null,enable:function(){this._subscription=this._layer.subscribe('hide',g.remove.curry(this._layer.getRoot()));},disable:function(){if(this._subscription){this._subscription.unsubscribe();this._subscription=null;}}});e.exports=i;});
__d("ContextualDialogArrow",["CSS","DOM","Locale","Style","Vector","copyProperties","cx"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOM'),i=b('Locale'),j=b('Style'),k=b('Vector'),l=b('copyProperties'),m=b('cx'),n=15,o=16,p={bottom:"_k8",top:"_k9",right:"_ka",left:"_kb"},q={above:'bottom',below:'top',left:'right',right:'left'};function r(s){this._layer=s;}l(r.prototype,{_subscription:null,_arrow:null,enable:function(){this._subscription=this._layer.subscribe(['adjust','reposition'],this._handle.bind(this));},disable:function(){this._subscription.unsubscribe();this._subscription=null;},_handle:function(s,t){if(s==='adjust'){this._repositionArrow(t);}else this._repositionRoot(t);},_repositionRoot:function(s){var t=this._layer.getRoot();if(!s.isVertical()){var u=parseInt(j.get(t,'top'),10);u-=n;j.set(t,'top',u+'px');}},_repositionArrow:function(s){var t=this._layer._contentWrapper,u=0,v=s.getAlignment(),w=s.getPosition();if(w=='above'||w=='below')if(v=='center'){u=50;}else if(v=='right')u=100;var x=q[w];for(var y in p)g.conditionClass(t,p[y],x===y);if(w=='none')return;if(!this._arrow){this._arrow=this._drawArrow();h.appendContent(t,this._arrow);}g.conditionClass(t,"_kc",this._layer.getFooter());j.set(this._arrow,'top','');j.set(this._arrow,'left','');j.set(this._arrow,'right','');j.set(this._arrow,'margin','');var z=x=='top'||x=='bottom',aa=z?(i.isRTL()?'right':'left'):'top';j.set(this._arrow,aa,u+'%');var ba=0;if(v!='center'){ba=n;if(z){var ca=this._layer.getContext(),da=k.getElementDimensions(ca).x;if(da<o+(n*2))ba=Math.max((da/2)-(o/2),0);}}ba+=o*u/100;if(v!='left')ba*=-1;j.set(this._arrow,'margin-'+aa,ba+'px');},_drawArrow:function(){return h.create('i',{className:"_kd"});}});r.OFFSET=n;r.LENGTH=o;e.exports=r;});
__d("ContextualDialogFitInViewport",["event-extensions","ContextualDialogArrow","ContextualLayerDimensions","Style","Vector","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('ContextualDialogArrow'),h=b('ContextualLayerDimensions'),i=b('Style'),j=b('Vector'),k=b('copyProperties'),l=g.OFFSET,m=g.LENGTH,n=l+m;function o(p){this._layer=p;}k(o.prototype,{_scrollListener:null,_subscription:null,_minimumTop:null,enable:function(){this._subscription=this._layer.subscribe(['show','hide','reposition'],function(p,q){if(p=='reposition'){this._calculateMinimumTop(q);}else if(p=='show'){this._attachScroll();this._adjustForScroll();}else this._detachScroll();}.bind(this));if(this._layer.isShown())this._attachScroll();},disable:function(){if(this._layer.isShown())this._detachScroll();this._subscription.unsubscribe();this._subscription=null;},_attachScroll:function(){this._scrollListener=Event.listen(this._layer.getContextScrollParent()||window,'scroll',this._adjustForScroll.bind(this));},_detachScroll:function(){this._scrollListener.remove();this._scrollListener=null;},_getContentHeight:function(){return j.getElementDimensions(this._layer._contentWrapper).y;},_getContextY:function(){return j.getElementPosition(this._layer.getContext()).y;},_calculateMinimumTop:function(p){if(p.isVertical())return;this._minimumTop=(this._getContextY()-(this._getContentHeight()-n)+p.getOffsetY());},_adjustForScroll:function(){var p=this._layer._getOrientation();if(p.isVertical())return;var q=h.getViewportRect(this._layer),r=q.b-this._minimumTop;if(r<0)return;var s=this._getContentHeight(),t=s-(n+l),u=Math.max(0,Math.min(t,t-(r-s)));i.set(this._layer.getContent(),'top',-u+'px');}});e.exports=o;});
__d("ContextualDialog",["AccessibleLayer","Class","ContextualDialogFitInViewport","ContextualLayer","CSS","DOM","LayerButtons","LayerFormHooks","LayerMouseHooks","Style","copyProperties","csx","cx"],function(a,b,c,d,e,f){var g=b('AccessibleLayer'),h=b('Class'),i=b('ContextualDialogFitInViewport'),j=b('ContextualLayer'),k=b('CSS'),l=b('DOM'),m=b('LayerButtons'),n=b('LayerFormHooks'),o=b('LayerMouseHooks'),p=b('Style'),q=b('copyProperties'),r=b('csx'),s=b('cx');function t(u,v){this.parent.construct(this,u,v);}h.extend(t,j);q(t.prototype,{_footer:null,_configure:function(u,v){u.addedBehaviors.push(u.arrowBehavior);var w=l.scry(v,"div._k7");if(w.length)this._footer=w[0];this.parent._configure(u,v);},_getDefaultBehaviors:function(){return this.parent._getDefaultBehaviors().concat([g,i,m,n,o]);},_buildWrapper:function(u,v){k.addClass(v,"_k5");var w=this.parent._buildWrapper(u,v);k.addClass(this._contentWrapper,"_k6");if(u.width)this.setWidth(u.width);return w;},setWidth:function(u){this._width=Math.floor(u);p.set(this._contentWrapper,'width',u+'px');return this;},getFooter:function(){return this._footer;}});q(t,{setContext:function(u,v){u.setContext(v);}});e.exports=t;});
__d("ButtonGroup",["function-extensions","copyProperties","createArrayFrom","CSS","DataStore","Parent"],function(a,b,c,d,e,f){b('function-extensions');var g=b('copyProperties'),h=b('createArrayFrom'),i=b('CSS'),j=b('DataStore'),k=b('Parent'),l='firstItem',m='lastItem';function n(s,t){var u=k.byClass(s,t);if(!u)throw new Error('invalid use case');return u;}function o(s){return i.shown(s)&&h(s.childNodes).some(i.shown);}function p(s){var t,u,v;h(s.childNodes).forEach(function(w){v=o(w);i.removeClass(w,l);i.removeClass(w,m);i.conditionShow(w,v);if(v){t=t||w;u=w;}});t&&i.addClass(t,l);u&&i.addClass(u,m);i.conditionShow(s,t);}function q(s,t){var u=n(t,'uiButtonGroupItem');s(u);p(u.parentNode);}function r(s){this._root=n(s,'uiButtonGroup');j.set(this._root,'ButtonGroup',this);p(this._root);}r.getInstance=function(s){var t=n(s,'uiButtonGroup'),u=j.get(t,'ButtonGroup');return u||new r(t);};g(r.prototype,{hideItem:q.curry(i.hide),showItem:q.curry(i.show),toggleItem:q.curry(i.toggle)});e.exports=r;});
var SubscribeButton=window.SubscribeButton||(function(){return {SUBSCRIBED:'FollowingUser',UNSUBSCRIBED:'UnfollowingUser',init:function(a,b,c,d){Event.listen(b,'click',function(){Arbiter.inform(SubscribeButton.SUBSCRIBED,{profile_id:d});});Arbiter.subscribe(SubscribeButton.SUBSCRIBED,function(e,f){if(d===f.profile_id)a.swap();});Arbiter.subscribe(SubscribeButton.UNSUBSCRIBED,function(e,f){if(d===f.profile_id){a.unswap();c.hideFlyout();Arbiter.inform('SubMenu/Reset');}});},initUnsubscribe:function(a,b){Event.listen(a,'click',function(){Arbiter.inform.bind(Arbiter,SubscribeButton.UNSUBSCRIBED,{profile_id:b}).defer();});}};})();
__d("DynamicFriendListEducation",["event-extensions","Arbiter","AsyncRequest","Dialog","PageTransitions","createArrayFrom"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('AsyncRequest'),i=b('Dialog'),j=b('PageTransitions'),k=b('createArrayFrom'),l,m,n,o,p,q;function r(){n&&n.hide();o&&o.hide();}function s(v){m.remove(v);r();p({accept_tag_education:true});}function t(){r();p({nux_cancel:true});}var u={init:function(v,w){l=v;m=k(w).map(String);j.registerHandler(function(){r();l=false;p=undefined;m=[];});},showDialog:function(v,w,x){if(l&&m.contains(v)){r();g.inform('DynamicFriendListEducation/dialogOpen',{uid:w,flid:v});p=x;n=new i().setAsync(new h('/ajax/friends/lists/smart_list_education.php').setMethod('GET').setData({flid:v,uid:w}).setReadOnly(true)).setHandler(s.bind(this,v)).setCloseHandler(function(){g.inform('DynamicFriendListEducation/dialogClosed',{uid:w,flid:v});}).setCancelHandler(function(){g.inform('DynamicFriendListEducation/dialogCancel',{uid:w,flid:v});}).show();}else x();},showContextualDialog:function(v,w,x,y){if(l&&m.contains(v)){r();q=x;p=y;new h('/ajax/friends/lists/smart_list_contextual_education.php').setMethod('GET').setData({flid:v,uid:w}).setReadOnly(true).send();}else y();},setContextualDialog:function(v,w,x,y){o=v;o.setContext(q);o.show();Event.listen(w,'click',s.bind(this,y));Event.listen(x,'click',t);}};e.exports=u;});
__d("FriendStatus",["array-extensions","function-extensions","Arbiter","AsyncRequest","copyProperties","createArrayFrom"],function(a,b,c,d,e,f){b('array-extensions');b('function-extensions');var g=b('Arbiter'),h=b('AsyncRequest'),i=b('copyProperties'),j=b('createArrayFrom');function k(o,p,q){this.id=o;this.update(p,q);}i(k.prototype,{update:function(o,p){o&&(this.status=o);if(p){this.lists=j(p).map(String);this._informListChange();}},isComplete:function(){return !!this.lists;},addToList:function(o){if(this.lists&&!this.lists.contains(o))this.lists.push(o);this._informListChange();},removeFromList:function(o){if(this.lists){var p=this.lists.indexOf(o);p!==-1&&this.lists.splice(p,1);}this._informListChange();},updateList:function(o,p){p?this.addToList(o):this.removeFromList(o);},_informListChange:function(){g.inform('FriendListMembershipChange',{uid:this.id,lists:this.lists});}});i(k,{ARE_FRIENDS:1,INCOMING_REQUEST:2,OUTGOING_REQUEST:3,CAN_REQUEST:4});var l={},m={};function n(o,p,q){if(!l[q.uid]){l[q.uid]=new k(q.uid,o);}else l[q.uid].update(o);g.inform('FriendRequest/change',{uid:q.uid,status:o});}g.subscribe(['FriendRequest/cancel','FriendRequest/unfriend','FriendRequest/sendFail'],n.curry(k.CAN_REQUEST));g.subscribe(['FriendRequest/confirmFail'],n.curry(k.INCOMING_REQUEST));g.subscribe(['FriendRequest/cancelFail','FriendRequest/sent','FriendRequest/sending'],n.curry(k.OUTGOING_REQUEST));g.subscribe(['FriendRequest/confirm','FriendRequest/confirming'],n.curry(k.ARE_FRIENDS));i(k,{CLOSE_FRIENDS:null,ACQUAINTANCES:null,getFriend:function(o,p){if(l[o]&&l[o].isComplete()){p(l[o]);}else if(m[o]){m[o].push(p);}else{m[o]=[p];new h().setURI("/ajax/friends/status.php").setData({friend:o}).setHandler(function(q){var r=q.getPayload();k.initFriend.bind(k,o,r.status,r.lists).defer();}).send();}},initFriend:function(o,p,q){var r=l[o]||new k(o);r.update(r.status||p,r.lists||q);l[o]=r;m[o]&&m[o].forEach(function(s){s(r);});m[o]=null;},setSpecialLists:function(o){k.CLOSE_FRIENDS=o.close+'';k.ACQUAINTANCES=o.acq+'';}});e.exports=k;});
__d("FriendEditLists",["Arbiter","AsyncRequest","CSS","DOMQuery","DynamicFriendListEducation","EditSubscriptions","FriendStatus","Menu","Parent","ScrollableArea","URI","$","copyProperties","ge"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AsyncRequest'),i=b('CSS'),j=b('DOMQuery'),k=b('DynamicFriendListEducation'),l=b('EditSubscriptions'),m=b('FriendStatus'),n=b('Menu'),o=b('Parent'),p=b('ScrollableArea'),q=b('URI'),r=b('$'),s=b('copyProperties'),t=b('ge'),u=5,v={},w="/ajax/profile/removefriendconfirm.php",x='/ajax/friends/requests/cancel.php',y='/ajax/choose/',z;function aa(ka,la,ma){var na=v[ka.id],oa=function(pa){var qa={action:ma?'add_list':'del_list',to_friend:na.id,friendlists:[la],source:z};if(pa)s(qa,pa);na.updateList(la,ma);var ra;if(ma&&la==m.CLOSE_FRIENDS){ra=da(ka,m.ACQUAINTANCES);if(n.isItemChecked(ra)){n.toggleItem(ra);aa(ka,m.ACQUAINTANCES,false);}}else if(ma&&la==m.ACQUAINTANCES){ra=da(ka,m.CLOSE_FRIENDS);if(n.isItemChecked(ra)){n.toggleItem(ra);aa(ka,m.CLOSE_FRIENDS,false);}}var sa={flid:la,uid:na.id},ta=ma?'FriendListHovercard/add':'FriendListHovercard/remove';g.inform(ta,sa);new h().setURI('/ajax/add_friend/action.php').setData(qa).send();};if(ma){k.showDialog(la,na.id,oa);}else oa();}function ba(ka){var la=j.scry(ka,'input')[0];return la&&la.value;}function ca(ka,la,ma){var na={uid:la.id};new h().setURI(x).setMethod('POST').setData({friend:la.id}).setHandler(g.inform.bind(g,'FriendRequest/cancel',na)).setErrorHandler(g.inform.bind(g,'FriendRequest/cancelFail',na)).setStatusElement(ma).send();}function da(ka,la){var ma=n.getItems(ka);for(var na=0;na<ma.length;na++)if(ba(ma[na])==la)return ma[na];return null;}function ea(ka,la){var ma=n.getItems(ka);ma.forEach(function(na){var oa=ba(na),pa=la.lists.contains(oa);if(n.isItemChecked(na)!==pa)n.toggleItem(na);});}function fa(ka){var la=n.getItems(ka),ma=!i.hasClass(ka,'followButtonFlyout')&&!i.hasClass(ka,'likeButtonFlyout'),na=[],oa=[],pa=0,qa=0;la.forEach(function(va){if(i.hasClass(va,'neverHide')){i.removeClass(va,'underShowMore');pa++;}else if(n.isItemChecked(va)){na.push(va);}else if(i.hasClass(va,'neverShow')||i.hasClass(va,'FriendListCreateTrigger')||(!ma&&i.hasClass(va,'friendOptionsOnly'))){i.addClass(va,'underShowMore');qa++;}else oa.push(va);});var ra=u-pa,sa=na.concat(oa),ta=qa;sa.forEach(function(va){if(i.hasClass(va,'ShowMoreItem')){ra--;return;}if(ra){i.removeClass(va,'underShowMore');ra--;}else{i.addClass(va,'underShowMore');ta=true;}});i.conditionClass(ka,'hasMoreFriendListItems',ta);var ua=j.scry(ka,'.FriendListMenuShowMore');ua.forEach(function(va){i.removeClass(va,'FriendListMenuShowMore');});}function ga(ka,la){i.conditionClass(ka,'FriendListMemorializedUser',la);}function ha(ka,la){var ma=j.scry(ka,'.FriendListUnfriend')[0],na=j.scry(ka,'.FriendListCancel')[0],oa=j.scry(ka,'.FriendListSuggestFriends')[0];if(na)i.conditionShow(na,la.status==m.OUTGOING_REQUEST);if(ma){i.conditionShow(ma,la.status==m.ARE_FRIENDS);j.find(ma,'a').setAttribute('ajaxify',q(w).addQueryData({uid:la.id}).toString());}if(oa)j.find(oa,'a').setAttribute('href',q(y).addQueryData({type:'suggest_friends',newcomer:la.id,ref:'profile_others_dropdown'}).toString());}function ia(ka,la){var ma=j.scry(ka,'div.FriendListSubscriptionsMenu');if(ma.length!==0)l.init(ka,la,45);}g.subscribe('FriendRequest/change',function(ka,la){for(var ma in v){var na=t(ma),oa=v[ma];if(na&&oa&&oa.id==la.uid){ea(na,oa);ha(na,oa);fa(na);}}});n.subscribe('select',function(ka,la){if(i.hasClass(la.item,'ShowMoreItem')&&i.hasClass(la.menu,'FriendListMenu')){i.addClass(la.menu,'FriendListMenuShowMore');p.poke(la.item);}});var ja={init:function(ka,la,ma,na){ka=r(ka);z=ma;if(!v[ka.id])n.subscribe('select',function(oa,pa){if(j.contains(ka,pa.item))if(o.byClass(pa.item,'FriendListItem')){n.toggleItem(pa.item);var qa=ba(pa.item);aa(ka,qa,n.isItemChecked(pa.item));}else if(o.byClass(pa.item,'FriendListCancel')){ca(ka,v[ka.id],pa.item);}else if(o.byClass(pa.item,'FriendListUnfriend'))g.inform('FriendEditLists/unfriend');});i.addClass(ka,'async_saving');m.getFriend(la,function(oa){ga(ka,na);ea(ka,oa);ha(ka,oa);v[ka.id]=oa;fa(ka);ia(ka,la);i.removeClass(ka,'async_saving');}.bind(this));}};e.exports=a.FriendEditLists||ja;});
__d("FriendListFlyoutController",["event-extensions","Arbiter","AsyncRequest","Button","CSS","DataStore","Dialog","DOM","ContextualLayer","FriendEditLists","FriendStatus","Layer","Parent","ScrollableArea","UserAgent"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('AsyncRequest'),i=b('Button'),j=b('CSS'),k=b('DataStore'),l=b('Dialog'),m=b('DOM'),n=b('ContextualLayer'),o=b('FriendEditLists'),p=b('FriendStatus'),q=b('Layer'),r=b('Parent'),s=b('ScrollableArea'),t=b('UserAgent'),u,v,w=null,x=null,y,z,aa,ba,ca,da,ea=1500,fa={init:function(va){fa.init=bagofholding;u=va;u.subscribe('mouseenter',ga);u.subscribe('mouseleave',qa);u.subscribe('hide',ha);if(w)m.setContent(u.getContent(),[w,x]);var wa=function(xa){var ya=r.byClass(xa.getTarget(),'enableFriendListFlyout');if(ya)if(y===ya){clearTimeout(ba);}else{v&&sa();pa(ya);}};Event.listen(document.documentElement,{mouseover:wa,click:wa});g.subscribe('FriendEditLists/unfriend',sa);g.subscribe('DynamicFriendListEducation/dialogOpen',function(){da=true;});g.subscribe('DynamicFriendListEducation/dialogClosed',function(){da=false;qa();});},initContent:function(va){m.appendContent(document.body,va);(function(){if(!w){w=va;u&&m.setContent(u.getContent(),[w,x]);j.show(w);Event.listen(w,'click',ta);v&&ma(y);}else{m.remove(va);va=null;}}).defer();},initNux:function(va){if(x)return;x=va;u&&m.setContent(u.getContent(),[w,x]);},show:function(va){na(va);},hide:function(va){va===false?sa():qa();},setActiveNode:function(va){v&&sa();y=va;z=Event.listen(va,'mouseleave',function(){y=null;z&&z.remove();});},setCloseListener:function(va,wa){k.set(va,'flfcloselistener',wa);if(y!=va)k.set(va,'flfcloselistenertimeout',ua.curry(va).defer(ea));},setCloseListenerTimeout:function(va){ea=va;}};function ga(){clearTimeout(ba);}function ha(){if(y){j.removeClass(y,'selected');j.removeClass(y,'uiButtonHover');if(k.get(y,'flfcloselistener')){var va=y;k.set(y,'flfcloselistenertimeout',ua.curry(va).defer(ea));}}v=false;la();y=null;}function ia(va){if(m.isNodeOfType(va,'label')&&j.hasClass(va,'uiButton'))va=i.getInputElement(va);return va;}function ja(va){return k.get(ia(va),'profileid');}function ka(va){return k.get(ia(va),'memorialized')==='true';}function la(){z&&z.remove();z=null;ca&&q.unsubscribe(ca);ca=null;ba&&clearTimeout(ba);ba=null;}function ma(va){var wa=ja(va),xa=ka(va),ya=k.get(va,'flloc');o.init(w,wa,ya,xa);j.conditionClass(w,'followButtonFlyout',j.hasClass(va,'profileFollowButton'));j.conditionClass(w,'friendButtonFlyout',j.hasClass(va,'FriendRequestFriends')||j.hasClass(va,'FriendRequestIncoming')||j.hasClass(va,'FriendRequestOutgoing'));j.conditionClass(w,'likeButtonFlyout',j.hasClass(va,'profileLikeButton'));var za=m.scry(w,'div.uiScrollableArea')[0];za&&s.poke(za);}function na(va){if(!u||v)return;u.setContext(va);u.setCausalElement(va);va.setAttribute('aria-expanded','true');j.addClass(va,'selected');j.addClass(va,'uiButtonHover');u.show();y=va;v=true;if(w){ma(va);}else new h().setURI('/ajax/friends/lists/flyout_content.php').setStatusElement(u.getContent()).send();la();z=Event.listen(va,'mouseleave',qa);ca=q.subscribe('show',oa);if(k.get(va,'flfcloselistener'))clearTimeout(k.remove(va,'flfcloselistenertimeout'));var wa=ja(va);p.getFriend(wa,function(xa){if(!x)return;if(xa.status==p.OUTGOING_REQUEST){j.show(x);h.bootstrap('/ajax/friends/lists/nux_flyout.php',null,true);}else j.hide(x);});}function oa(va,wa){if(!(wa instanceof n)||!m.contains(y,wa.getContext()))qa();}function pa(va){y=va;aa=na.curry(va).defer(350);z=Event.listen(va,'mouseleave',function(){clearTimeout(aa);y=null;z&&z.remove();});}function qa(){ba=sa.defer(150);}function ra(){var va=l.getCurrent(),wa=va&&va.getBody();return !!(wa&&m.scry(wa,'.friendListDialogTourCarousel')[0]);}function sa(){if(da||ra())return;t.ie()<8&&document.documentElement.focus();if(u){u.hide();var va=u.getCausalElement();va&&va.setAttribute('aria-expanded','false');}}function ta(event){var va=r.byTag(event.getTarget(),'a');if(va&&j.hasClass(va,'FriendListActionItem'))qa();}function ua(va){var wa=k.remove(va,'flfcloselistener');wa&&wa();}e.exports=a.FriendListFlyoutController||fa;});
__d("legacy:FriendListFlyoutController",["FriendListFlyoutController"],function(a,b,c,d){a.FriendListFlyoutController=b('FriendListFlyoutController');},3);
__d("legacy:FriendStatus",["FriendStatus"],function(a,b,c,d){a.FriendStatus=b('FriendStatus');},3);
var AddFriendButton={ERROR_ALREADY_ADDED:1431005,init:function(a,b,c,d,e,f,g,h,i,j,k){var l=null,m=DOM.scry(a,'.addButton')[0],n=DOM.scry(a,'.addFriendText')[0],o=DOM.scry(a,'.outgoingButton')[0],p=DOM.scry(a,'.incomingButton')[0],q=DOM.scry(a,'.friendButton')[0];function r(w,x,y){var z=new URI(m.getAttribute('ajaxify'));link_data=collect_data_attribs(a,['ft','gt']);new AsyncRequest().setURI(f).setData({to_friend:b,action:w,how_found:d,ref_param:e,link_data:link_data,outgoing_id:o.id,xids:z.getQueryData().xids,logging_location:g,no_flyout_on_click:h,ego_log_data:i,http_referer:k}).setErrorHandler(x).setServerDialogCancelHandler(y).setRelativeTo(o).send();}function s(w,x){if(n){CSS.hide(n);}else if(m)CSS.hide(m);o&&CSS.hide(o);p&&CSS.hide(p);q&&CSS.hide(q);if(w)CSS.show(w);if('Outgoing'==x&&l!=x&&j)animation(w).from('backgroundColor','#FFF8CC').to('backgroundColor','transparent').from('borderColor','#FFE222').to('borderColor',Style.get(w,'borderLeftColor')).duration(2000).go();l&&CSS.removeClass(a,'fStatus'+l);l=x;CSS.addClass(a,'fStatus'+x);}function t(w){if(CSS.hasClass(w,'enableFriendListFlyout')){FriendListFlyoutController.show(w);}else FriendListFlyoutController.hide();}var u=Arbiter.subscribe('FriendRequest/change',function(w,x){if(x.uid!=b)return;switch(x.status){case FriendStatus.ARE_FRIENDS:return s(q,'Friends');case FriendStatus.INCOMING_REQUEST:return s(p,'Incoming');case FriendStatus.OUTGOING_REQUEST:return s(o,'Outgoing');case FriendStatus.CAN_REQUEST:return s(n?n:m,'Requestable');}}),v;if(c)v=Arbiter.subscribe('FriendRequest/confirm',function(w,x){x.uid==b&&goURI(c);});m&&Event.listen(m,'click',function(){Arbiter.inform('FriendRequest/sending',{uid:b});if(h){FriendListFlyoutController.setActiveNode(o);}else t(o);r("add_friend",function(w){var x=w.error==AddFriendButton.ERROR_ALREADY_ADDED?'FriendRequest/sent':'FriendRequest/sendFail';Arbiter.inform(x,{uid:b});FriendListFlyoutController.hide();AsyncResponse.defaultErrorHandler(w);},function(w){Arbiter.inform('FriendRequest/sendFail',{uid:b});FriendListFlyoutController.hide();});});PageTransitions.registerHandler(function(){u.unsubscribe();v&&v.unsubscribe();});}};
var FriendButtonIcon={init:function(a,b,c){var d=DOM.find(b,'.defaultIcon'),e=DOM.find(b,'.closeIcon'),f=DOM.find(b,'.acqIcon');Arbiter.subscribe('FriendListMembershipChange',function(g,h){if(h.uid==c){var i=h.lists.contains(FriendStatus.CLOSE_FRIENDS),j=h.lists.contains(FriendStatus.ACQUAINTANCES);if(i&&!j){Button.setIcon(a,e);}else if(j&&!i){Button.setIcon(a,f);}else Button.setIcon(a,d);}});}};
__d("BrokenProfilePicLogger",["Run","DOM","JSLogger"],function(a,b,c,d,e,f){var g=b("Run"),h=b("DOM"),i=b("JSLogger"),j=i.create("entities_profile_pics"),k={checkAndLog:function(l){g.onAfterLoad(function(){var m=h.find(l.parentNode,'img');if(!m.complete||(typeof m.naturalWidth!="undefined"&&m.naturalWidth===0))j.log('broken_link',{src:m.getAttribute('src')});});}};e.exports=k;});
__d("TimelineDrag",["event-extensions","ArbiterMixin","Class","Locale","Style","Vector","copyProperties"],function(a,b,c,d,e,f){b('event-extensions');var g=b('ArbiterMixin'),h=b('Class'),i=b('Locale'),j=b('Style'),k=b('Vector'),l=b('copyProperties');function m(n,o,p){p=p||{};this._listenOn=p.listenOn;this._offsetInput=o;this._defaultOffset=p.default_offset;this._killClicks=p.killClicks;this._vertical=true;this._RTLXSwitch=false;this.setPicture(n,p);}l(m.prototype,g,{setPicture:function(n,o){if(!n)return false;o=o||{};this._picture=n;this._defaultOffset=o.default_offset;if(o.vertical!==undefined)this._vertical=o.vertical;if(this._vertical){if(o.height)this._containerHeight=o.height;this._offsetType='top';this._eventCoord='y';}else{if(o.width)this._containerWidth=o.width;this._RTLXSwitch=i.isRTL();this._offsetType='left';this._eventCoord='x';}if(this._picture.complete){this._initialLoad();}else this._loadListener=Event.listen(this._picture,'load',function(){this._loadListener.remove();this._initialLoad();}.bind(this));},destroy:function(){this._stopDrag();this._saveOffset();this._mousedown&&this._mousedown.remove();this._onclick&&this._onclick.remove();this._loadListener&&this._loadListener.remove();},_initialLoad:function(){var n=this._listenOn?this._listenOn:this._picture;this._mousedown&&this._mousedown.remove();this._mousedown=Event.listen(n,'mousedown',this._onMouseDown.bind(this));if(this._vertical){this._maxOffset=this._containerHeight-this._picture.offsetHeight;}else this._maxOffset=this._containerWidth-this._picture.width;if(this._defaultOffset!==undefined)this._setOffset(this._defaultOffset);this._onclick&&this._onclick.remove();if(this._killClicks)this._onclick=Event.listen(n,'click',this._onClick.bind(this));this._saveOffset();},_onClick:function(event){event.kill();},_onMouseDown:function(event){var n=parseInt(j.get(this._picture,this._offsetType),10)||0;this._pictureStartDragOffset=n-k.getEventPosition(event)[this._eventCoord];this._startDrag();event.kill();},_startDrag:function(){if(!this._dragStarted){this.inform('startdrag',this);this._dragTokens=[Event.listen(document.documentElement,'mouseup',this._onMouseUp.bind(this)),Event.listen(document.documentElement,'mousemove',this._onMouseMove.bind(this))];this._dragStarted=true;}},_saveOffset:function(){var n=parseInt(j.get(this._picture,this._offsetType),10);if(this._RTLXSwitch){this._offsetInput.value=n+this._containerWidth-this._picture.offsetWidth;}else this._offsetInput.value=n;},_stopDrag:function(){if(this._dragStarted){this.inform('stopdrag',this);this._dragStarted=false;this._dragTokens.forEach(function(n){n.remove();});this._saveOffset();}},_onMouseUp:function(event){this._stopDrag();event.kill();},_setOffset:function(n){if(this._RTLXSwitch){n=Math.max(0,Math.min(n,-this._maxOffset));}else n=Math.min(0,Math.max(n,this._maxOffset));j.set(this._picture,this._offsetType,n+'px');},_onMouseMove:function(event){this._setOffset(this._pictureStartDragOffset+k.getEventPosition(event)[this._eventCoord]);event.kill();}});e.exports=m;});
__d("TimelineCover",["Button","CSS","DOM","HTML","Parent","DOMScroll","Vector","TimelineController","TimelineDrag","Style","$","copyProperties","ge"],function(a,b,c,d,e,f){var g=b('Button'),h=b('CSS'),i=b('DOM'),j=b('HTML'),k=b('Parent'),l=b('DOMScroll'),m=b('Vector'),n=b('TimelineController'),o=b('TimelineDrag'),p=b('Style'),q=b('$'),r=b('copyProperties'),s=b('ge');function t(u,v,w){this.root=q('fbProfileCover');this._parentSection=k.byClass(this.root,'fbTimelineSection');this._coverHeight=v;this.cover=i.find(this.root,'.cover');t.instance=this;this.previewing=w;this.editing=false;if(w){this.editMode();this.updateCoverImage(w);}else if(this.cover.getAttribute('data-collapse'))this._expandCover(parseInt(this.cover.getAttribute('data-collapse'),10));n.register(n.COVER,this);}t.instance=null;t.getInstance=function(){return t.instance;};r(t.prototype,{showLoadingIndicator:function(){var u=s('fbCoverImageContainer');if(u)h.addClass(u,'opaquedLoading');},hideLoadingIndicator:function(){var u=s('fbCoverImageContainer');if(u)h.removeClass(u,'opaquedLoading');},editMode:function(){g.setEnabled(i.find(this.root,'label.cancelButton'),true);g.setEnabled(i.find(this.root,'label.saveButton'),true);this.hideLoadingIndicator();this._coverImage=i.scry(this.root,'.coverImage')[0];var u=i.scry(this._coverImage,'.coverWrap')[0];if(u)this._originalOffset=p.get(i.find(u,'.coverPhotoImg'),'top');h.addClass(this._parentSection,'fbEditCover');l.scrollTo(this.root);if(this.previewing){i.remove(this._coverImage);h.show(this._coverImage);}var v=i.scry(this._coverImage,'.coverPhotoImg')[0];if(v)this._createDragger();this.editing=true;},_expandCover:function(u){u-=1;this.cover.style.marginTop='0px';if(u!=m.getScrollPosition().y){window.scrollBy(0,u);n.coverHasExpanded(u);}},_exitEditMode:function(){if(this._timelineDrag){this._timelineDrag.destroy();this._timelineDrag=null;}i.find(this.root,'input.hiddenPhotoID').value=null;i.find(this.root,'input.hiddenVideoID').value=null;g.setEnabled(i.find(this.root,'label.cancelButton'),false);g.setEnabled(i.find(this.root,'label.saveButton'),false);h.removeClass(this._parentSection,'fbEditCover');this.hideLoadingIndicator();this.previewing=false;},_createDragger:function(){this._timelineDrag=new o(i.find(this.root,'.coverImage .coverPhotoImg'),i.find(this.root,'input.photoOffsetInput'),{height:this._coverHeight,listenOn:this.cover,vertical:true,killClicks:true});},updateCoverImage:function(u,v,w){this.videoID=w;if(v)this.editMode();i.find(this.root,'input.hiddenPhotoID').value=u;i.find(this.root,'input.hiddenVideoID').value=w||null;g.setEnabled(i.find(this.root,'label.saveButton'),true);if(v)i.replace(i.find(this.root,'.coverImage'),j(v));if(this._timelineDrag){this._timelineDrag.setPicture(i.find(i.find(this.root,'.coverImage'),'.coverPhotoImg'));}else this._createDragger();},cancelUpdate:function(){i.remove(i.scry(this.root,'.coverImage')[0]);i.prependContent(this.cover,this._coverImage);if(this._originalOffset!==undefined)p.set(i.find(this._coverImage,'.coverPhotoImg'),'top',this._originalOffset);this._exitEditMode();},saveComplete:function(){this._coverImage=i.scry(this.root,'.coverImage')[0];this._exitEditMode();},isInEditMode:function(){return this.editing;}});e.exports=t;});
function TimelineCoverDisclaimer(a,b,c){if(TimelineCoverDisclaimer.displayed===undefined){TimelineCoverDisclaimer.displayed=true;}else return;new Dialog().setModal(true).setTitle(a).setBody(b).setButtonsMessage(c).setButtons(Dialog.OK).show();}
__d("TimelineFriendsNavHovercard",["event-extensions","Hovercard","UserAgent"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Hovercard'),h=b('UserAgent');function i(event){var k=event.getTarget();g.processNode(k)&&event.stop();}var j={init:function(k){if(h.ie()<7)return;Event.listen(k,'mouseover',i);}};e.exports=j;});
__d("TimelineNavigation",["event-extensions","Arbiter","DOM","CSS","PageTransitions","Parent","TimelineController","TimelineURI","URI","$","createArrayFrom","ge"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('DOM'),i=b('CSS'),j=b('PageTransitions'),k=b('Parent'),l=b('TimelineController'),m=b('TimelineURI'),n=b('URI'),o=b('$'),p=b('createArrayFrom'),q=b('ge'),r=4,s=110,t=20,u=119,v=328,w=10,x=3,y=false,z=21,aa,ba,ca,da=[],ea=[],fa,ga=0,ha,ia=0,ja=0,ka,la=r,ma=false,na=false,oa=null,pa,qa=false,ra,sa,ta=false;function ua(ib,jb,kb){if(!jb.firstChild){h.remove(jb);return;}ea.push(jb);xa(kb.recent);i.removeClass(k.byTag(jb,'li'),'empty');if(fa&&(ia>r||ja>0))i.removeClass(fa,'notready');wa();if(kb.async){bb();db();}}function va(ib,jb,kb){h.remove(k.byTag(jb,'li'));if(!kb.async){ka++;}else{ia--;bb();db();}wa();}function wa(){var ib=fa?0:z;if(ia<=r){var jb=v+u*Math.max(0,r-ia)+ib;ha.style.width=jb+'px';la=ia;ya();}}function xa(ib){if(ib){ja++;}else ia++;ya();}function ya(){if(!ra)return;var ib=Math.max(0,ia-r)+ja;if(ga&&fa){h.setContent(ga,ib===0?" ":ib);i.conditionClass(fa,'fbTimelineMoreButtonZero',ib===0);if(!ma)i.conditionShow(fa,ib>0);}}function za(){var ib=h.scry(o('fbTimelineNavTopRow'),'li.tile'),jb=0,kb=0,lb=Math.max(0,r-la),mb=false;for(var nb=0;nb<ib.length;nb++){if(ib[nb]==ha||ib[nb]==fa)continue;mb=((jb+lb)%r===0);i.conditionClass(ib[nb],'leftMost',(jb!==0&&mb));if(!i.hasClass(ib[nb],'empty'))kb=jb;jb++;}mb=((kb+1+lb)%r===0);var ob=ib.length-1-lb;if(mb){if(ma&&(kb+1+lb)/r<x){ob=Math.min(ob,kb+r);na=true;}else ob=kb;}else{var pb=((kb+1+lb)%r);ob=kb+(r-pb);na=false;}nb=0;for(nb=0;nb<=ob;nb++)if(ib[nb]&&(ib[nb]==ha||ib[nb]==fa)){ob++;}else ib[nb]&&i.hasClass(ib[nb],'empty')&&i.removeClass(ib[nb],'hidden_elem');}function ab(ib,jb,kb){var lb=h.scry(ib,'li.tile');if(!jb)jb=0;var mb=false;for(var nb=jb;nb<lb.length;nb++){mb=((nb-kb)%r===0);var ob=lb[nb];i.conditionClass(ob,'leftMost',mb);if(i.hasClass(ob,'empty'))i.removeClass(ob,'hidden_elem');}}function bb(){za();var ib=q('fbTimelineNavSecondaryRow');ib&&ab(ib,0,0);}function cb(){if(!fa)return;if(i.hasClass(fa,'notready'))return;i.toggleClass(fa,'fbTimelineMoreButtonOpen');var ib=q('fbRecentAppTitle');ib&&i.conditionClass(ib,'hidden_elem',ja===0);if(i.hasClass(fa,'fbTimelineMoreButtonOpen')){bb();}else ya();db();}function db(){if(fa&&!i.hasClass(fa,'fbTimelineMoreButtonOpen')){aa.style.height='';i.removeClass(aa,'expanded');}else{var ib=ia+(r-la),jb=((ja>0)?w:0)+s*(Math.ceil(ja/r))+s*(Math.ceil(ib/r))+s*(na?1:0)+t;i.addClass(aa,'expanded');aa.style.height=jb+'px';}}function eb(ib){var jb=ib==m.TIMELINE_KEY||ib==m.WALL_KEY,kb=k.byClass(aa,'fbTimelineTopSectionBase'),lb=q('timeline_tour_toolbar');if(fa){i.removeClass(fa,'fbTimelineMoreButtonOpen');db();}lb&&i.conditionShow(lb,jb);if(kb)i.conditionClass(kb,'collapsedHead',!jb);}function fb(event){if(ta)return true;if(!k.byTag(event.getTarget(),'a')){var ib=h.find(ha,'a.title');j.go(ib.href);}}function gb(){if(fa)(function(){fa.removeAttribute('ajaxify');fa.removeAttribute('rel');}).defer();oa&&oa.remove();}var hb={UPDATE_PAGE:'TimelineNavigation/updatePage',init:function(ib,jb,kb,lb){if(y)return;y=true;aa=ib;fa=jb;ba=n.getRequestURI();ha=h.find(aa,'li.about');eb(l.getCurrentKey());ma=lb;g.inform(hb.UPDATE_PAGE);if(fa){ga=h.find(fa,'div.text');oa=Event.listen(fa,'click',gb);}pa=o('fbTimelineNavigationLoadContainer');h.appendContent(o('content'),pa);sa=Event.listen(ha,'click',fb);da.forEach(function(nb){if(!nb[2].remove){ua.apply(this,nb);}else va.apply(this,nb);});da=[];var mb=k.byClass(ib,'fbTimelineSection');if(mb)h.scry(mb,'ul.uiButtonGroup').forEach(function(nb){p(nb.childNodes).forEach(function(ob){ob.childNodes.length||h.remove(ob);});if(nb.firstChild){i.addClass(nb.firstChild,'firstItem');}else h.remove(nb);});l.register(l.NAV,hb);},reset:function(){sa&&sa.remove();sa=null;ra&&ra.remove();ra=null;y=false;aa=null;ca=null;ea=[];fa=null;ga=null;ha=null;ia=0;ja=0;ka=0;la=r;ma=false;na=false;pa=null;qa=false;ta=false;},initializeMorePager:function(){if(ra)return;if(fa)ra=Event.listen(fa,'click',cb);},registerNav:function(ib,jb,kb){y?(kb.remove?va.apply(this,arguments):ua.apply(this,arguments)):da.push(arguments);},redraw:function(){bb();db();},setEditMode:function(ib){ta=ib;}};e.exports=hb;});
__d("TimelineLogging",["TimelineController","reportData"],function(a,b,c,d,e,f){var g=b('TimelineController'),h=b('reportData'),i=false,j=0,k=null,l={init:function(m){if(i)return;j=m;g.register(g.LOGGING,this);},reset:function(){i=false;j=0;k=null;},log:function(m,n){n.profile_id=j;h(m,{gt:n});},logSectionChange:function(m,n){var o={timeline_section_change:1,key:m};if(k&&m==k){o.timeline_scrubber=1;k=null;}l.log('timeline',o);},logScrubberClick:function(m){k=m;}};e.exports=l;});
__d("TimelineStickyHeaderNav",["array-extensions","event-extensions","function-extensions","Arbiter","ButtonGroup","CSS","DOM","Parent","Selector","Style","TimelineController","URI","UserAgent","Vector","ge","tx"],function(a,b,c,d,e,f){b('array-extensions');b('event-extensions');b('function-extensions');var g=b('Arbiter'),h=b('ButtonGroup'),i=b('CSS'),j=b('DOM'),k=b('Parent'),l=b('Selector'),m=b('Style'),n=b('TimelineController'),o=b('URI'),p=b('UserAgent'),q=b('Vector'),r=b('ge'),s=b('tx'),t=false,u,v,w,x,y,z,aa,ba,ca,da,ea,fa={},ga={},ha=[],ia=false,ja=[],ka=[],la=[],ma=[],na=[],oa=["January","February","March","April","May","June","July","August","September","October","November","December"];function pa(event){var eb=k.byTag(event.getTarget(),'a');if(eb){n.navigateToSection(eb.getAttribute('data-key'));event.prevent();}}function qa(eb,fb){var gb=l.getValue(fb);if(gb==='allStories')n.getSection(eb).expandSubSections();if(gb!=='activityLog')ra(fb);}function ra(eb){bb(eb,'highlights');bb(eb,'allStories');var fb=j.find(eb,'li.separator');i.conditionShow(fb,fb.previousSibling);}function sa(eb){if(ca[eb]&&!v.custom_subsection_menu){ya(eb);}else va();n.adjustStickyHeaderWidth();}function ta(eb,fb){var gb=fb.key;if(da[gb]){za(gb);sa(gb);}}function ua(eb,fb){var gb=fb.scrubberKey;za(gb);if(w===gb)sa(gb);}function va(){x.hideItem(aa);}function wa(eb){var fb=eb.split('_');return oa[fb.pop()-1];}function xa(eb){var fb=ba[eb],gb=ca[eb];if(!fb&&gb){fb=ba[eb]=aa.cloneNode(true);var hb=j.scry(fb,'li.activityLog a')[0];if(hb)hb.href=o(hb.href).addQueryData({key:eb});var ib=n.getCurrentScrubber();if(gb.length)i.show(j.find(fb,'li.separator'));for(var jb=0;jb<gb.length;jb++){var kb=gb[jb].scrubberKey,lb=ib?ib.getLabelForSubnav(gb[jb].parentKey,kb):lb=wa(kb);if(lb)ab(fb,{key:kb,label:lb});}if(cb()){ra(fb);l.setSelected(fb,j.scry(fb,'option')[1].value,true);}na.push(l.listen(fb,'change',qa.curry(eb,fb)));la.push(Event.listen(fb,'click',pa));}return fb;}function ya(eb){var fb=xa(eb);j.insertAfter(aa,fb);i.hide(aa);for(var gb in ba){var hb=ba[gb];i.conditionShow(hb,hb===fb);}x.showItem(aa);}function za(eb){ca[eb]=n.getSection(eb).subSections;}function ab(eb,fb){var gb=j.create('a',{href:'#',rel:'ignore',className:'itemAnchor',tabIndex:0},j.create('span',{className:'itemLabel fsm'},fb.label));gb.setAttribute('data-key',fb.key);gb.setAttribute('aria-checked',false);var hb=j.create('li',{className:'uiMenuItem uiMenuItemRadio uiSelectorOption'},gb);hb.setAttribute('data-label',fb.label);var ib=j.find(eb,'ul.uiMenuInner'),jb=j.create('option',{value:fb.key},fb.label),kb=j.find(eb,'select');if(fb.key==='recent'){j.prependContent(ib,hb);j.insertAfter(kb.options[0],jb);}else{j.appendContent(ib,hb);j.appendContent(kb,jb);}}function bb(eb,fb){var gb=j.scry(eb,'li.uiMenuItem');if(!gb)return;for(var hb=0;hb<gb.length;hb++){var ib=gb[hb];if(i.hasClass(ib,fb)||ib.firstChild.getAttribute('data-key')==fb){j.remove(ib);break;}}var jb=j.find(eb,'select'),kb=j.scry(jb,'option');for(hb=0;hb<kb.length;hb++)if(kb[hb].value===fb){j.remove(kb[hb]);return;}}function cb(){return n.getCurrentKey()==='allactivity'||n.getCurrentKey()==='approve';}var db={init:function(eb,fb){if(t)return;t=true;u=eb;v=fb||{};y=j.find(u,'div.pageMenu');z=j.find(u,'div.sectionMenu');aa=j.find(u,'div.subsectionMenu');ea=j.find(y,'li.uiMenuSeparator');x=h.getInstance(y);ba={};ca={};da={};db.adjustMenuHeights();n.register(n.STICKY_HEADER_NAV,db);if(r('pagelet_timeline_friends'))db.addTimePeriods(n.getSectionKeys());ka.forEach(function(gb){gb();});},reset:function(){t=false;v={};ha=[];fa={};ga={};ia=false;ja=[];u=null;y=null;z=null;aa=null;ea=null;ba={};ca={};da={};while(la.length)la.pop().remove();ma.forEach(g.unsubscribe);na.forEach(l.unsubscribe.bind(l));},addTimePeriods:function(eb){if(!eb.length)return;if(v.pull_from_scrubber){j.setContent(j.find(z,'ul.uiMenuInner'),'');j.remove(j.find(z,'select').children[1]);while(eb.length){var fb=eb.shift();fb&&db.addTimePeriod(fb);}x.showItem(z);}var gb=l.getSelectorMenu(z);la.push(Event.listen(gb,'click',pa));var hb=cb()?n.SECTION_REGISTERED:n.SECTION_LOADED,ib=cb()?ua:ta;ma.push(g.subscribe(hb,ib));},addTimePeriod:function(eb){var fb=n.getCurrentScrubber();if(!fb)return;var gb=fb.getLabelForNav(eb);if(!gb)return;ab(z,{key:eb,label:gb});var hb=j.find(z,'ul.uiMenuInner');if(eb==='recent'||hb.children.length<2)l.setSelected(z,eb,true);},updateSection:function(eb,fb){if(fb){var gb=xa(eb);if(gb){l.setSelected(gb,fb);ra(gb);}else w=eb;}else{da[eb]=true;za(eb);}l.setSelected(z,eb,true);sa(eb);},adjustMenuHeights:function(){if(p.ie()<=7)return;[y,z].forEach(function(eb){var fb='';if(!i.hasClass(document.documentElement,'tinyViewport')){fb=q.getViewportDimensions().y-q.getElementDimensions(r('blueBar')).y-80;fb+='px';}m.set(j.find(eb,'ul.uiMenuInner'),'maxHeight',fb);});},initPageMenu:function(eb,fb){if(!t){ka.push(db.initPageMenu.curry(eb,fb));return;}function gb(hb,ib){hb.forEach(function(jb){var kb=ga[jb]=j.create('li');i.hide(kb);ib?j.insertBefore(ea,kb):j.appendContent(j.find(y,'ul.uiMenuInner'),kb);});}gb(eb,true);gb(fb,false);fa.info=j.scry(y,'li')[0];ha=fb;ia=true;if(ja.length)ja.forEach(function(hb){db.registerPageMenuItem(hb.key,hb.item);});},registerPageMenuItem:function(eb,fb){if(!ia){ja.push({key:eb,item:fb});return;}if(ga[eb]){j.replace(ga[eb],fb);fa[eb]=fb;delete ga[eb];if(ha.indexOf(eb)>=0)i.show(ea);}},removeTimePeriod:function(eb){bb(z,eb);}};e.exports=db;});
__d("legacy:TimelineCover",["TimelineCover"],function(a,b,c,d){a.TimelineCover=b('TimelineCover');},3);
__d("SwapButton",["event-extensions","copyProperties","CSS"],function(a,b,c,d,e,f){b('event-extensions');var g=b('copyProperties'),h=b('CSS');function i(j,k,l){this._swapperButton=j;this._swappeeButton=k;Event.listen(j,'click',this.swap.bind(this));if(l)Event.listen(k,'click',this.unswap.bind(this));}g(i.prototype,{_swapperButton:null,_swappeeButton:null,swap:function(){h.hide(this._swapperButton);h.show(this._swappeeButton);},unswap:function(){h.show(this._swapperButton);h.hide(this._swappeeButton);},toggle:function(){h.toggle(this._swapperButton);h.toggle(this._swappeeButton);}});e.exports=i;});
__d("HoverButton",["AsyncRequest","CSS","DOM","URI","copyProperties"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('CSS'),i=b('DOM'),j=b('URI'),k=b('copyProperties');function l(m,n,o,p){this._button=m;this._flyout=n;this._flyoutAjaxify=p;this._flyoutContent=o;n.subscribe('show',this._onShow.bind(this));n.subscribe('hide',this._onHide.bind(this));}k(l.prototype,{_button:null,_flyout:null,_flyoutAjaxify:null,_flyoutContent:null,showFlyoutBriefly:function(){this.showFlyout();this._flyout.hideFlyoutDelayed(5000);},showFlyout:function(){this._flyout.showFlyout(this._button,true);this._flyout.inform('show',this._button);},hideFlyout:function(){this._flyout.hideFlyout(true);this._flyout.inform('hide',this._button);},_onShow:function(m,n){h.addClass(n,'uiHoverButtonSelected');h.addClass(n,'selected');if(this._flyoutAjaxify){h.addClass(this._flyoutContent,'async_saving');new g().setURI(new j(this._flyoutAjaxify)).setHandler(function(o){h.removeClass(this._flyoutContent,'async_saving');i.setContent(this._flyoutContent,o.payload);}.bind(this)).send();this._flyoutAjaxify=null;}},_onHide:function(m,n){h.removeClass(n,'uiHoverButtonSelected');h.removeClass(n,'selected');},destroy:function(){this.hideFlyout();this._flyout.destroy();}});e.exports=l;});
__d("SubMenu",["event-extensions","Arbiter","copyProperties","CSS"],function(a,b,c,d,e,f){b('event-extensions');var g=b('Arbiter'),h=b('copyProperties'),i=b('CSS');function j(){}h(j.prototype,{_subMenu:null,_mainMenu:null,_forward:null,_backward:null,init:function(k,l,m,n){this._subMenu=k;this._mainMenu=l;this._forward=m;this._backward=n;g.subscribe('SubMenu/Reset',this._goToMainMenu.bind(this));Event.listen(m,'click',this._goToSubMenu.bind(this));Event.listen(n,'click',this._goToMainMenu.bind(this));},initAsyncChildMenu:function(k){Event.listen(this._forward,'click',function(){this._goToSubMenu();k.load();}.bind(this));},_goToMainMenu:function(){i.hide(this._subMenu);i.show(this._mainMenu);},_goToSubMenu:function(){i.hide(this._mainMenu);i.show(this._subMenu);}});e.exports=j;});
__d("legacy:ui-submenu",["SubMenu"],function(a,b,c,d){a.SubMenu=b('SubMenu');},3);
__d("AsyncMenu",["AsyncRequest","copyProperties"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('copyProperties');function i(j,k){this.init(j,k);}h(i.prototype,{_uri:null,_elem:null,init:function(j,k){this._uri=j;this._elem=k;},load:function(){this.load=bagofholding;g.bootstrap(this._uri,this._elem);}});e.exports=i;});
function FutureProfileSideNav(){this.parent.construct(this);}Class.extend(FutureProfileSideNav,'FutureSideNav');copyProperties(FutureProfileSideNav.prototype,{init:function(){this.parent.init.apply(this,arguments);this.ajaxPipe=true;this.altKeyParam='v';this.sidecol=false;},_constructItem:function(a,b){return new FutureProfileSideNavItem(a,b);},_doPageTransition:function(a,b){if(!this._profileChanged(b)&&!this._scopeChanged(a))return this.parent._doPageTransition(a,b);},_profileChanged:function(a){var b=a.getQueryData(),c=this.uri.getQueryData();return (b.id!==c.id||b.viewas!==c.viewas||b.and!==c.and);},_scopeChanged:function(a){return (!this.selected||a.layoutType!==this.selected.layoutType);},_getKey:function(a){return this.parent._getKey(a)||a[this.altKeyParam];}});function FutureProfileSideNavItem(a,b){this.parent.construct(this,a,b);this.layoutType=a.layouttype;}Class.extend(FutureProfileSideNavItem,'FutureSideNavItem');
__d("legacy:EditSubscriptions",["SubscriptionLevels","EditSubscriptions"],function(a,b,c,d){a.SubscriptionLevels=b('SubscriptionLevels');a.EditSubscriptions=b('EditSubscriptions');},3);
function couponTrackingSendRequest(a,b){link_data=collect_data_attribs(a,['ft','gt']);new AsyncRequest().setURI(b).setRelativeTo(a).setData({link_data:link_data}).send();}